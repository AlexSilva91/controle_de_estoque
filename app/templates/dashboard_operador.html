<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Operador</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles_operador.css') }}">
    <style>
        /* Estilos para o comportamento das abas e mensagens */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .flash-message {
            transition: opacity 1s ease-out;
        }
        
        /* Estilos para o status do caixa */
        .status-container {
            position: fixed;
            top: 20px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            z-index: 1000;
            pointer-events: none;
        }
        
        .caixa-status {
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: inline-flex;
            align-items: center;
            pointer-events: auto;
            animation: slideDown 0.5s ease-out;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .caixa-livre {
            background-color: #28a745;
            color: white;
        }
        
        .caixa-operacao {
            background-color: #ffc107;
            color: #212529;
        }
        
        .caixa-status i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .content-header {
            position: relative;
        }
        
        /* Estilos para a aba de vendas do dia */
        .sales-day-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .sales-day-table th, .sales-day-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .sales-day-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .sales-day-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .btn-void {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-void:hover {
            background-color: #c82333;
        }
        
        /* Estilos para o campo de desconto manual */
        .discount-control {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .discount-control input {
            flex: 1;
            margin-right: 10px;
        }
        
        .discount-type-select {
            width: 120px;
            margin-right: 10px;
        }
        
        .discount-badge {
            background-color: #28a745;
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-left: 5px;
        }
        
        .original-price {
            text-decoration: line-through;
            color: #6c757d;
            font-size: 0.9rem;
            display: block;
        }
        
        .discount-value {
            color: #28a745;
            font-size: 0.8rem;
            display: block;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='assets/logo.jpeg') }}" alt="Logo" class="logo">
            </div>
            
            <div class="user-info">
                <div class="user-greeting">Bem-vindo, {{ nome_usuario }}</div>
                <div class="current-date" id="current-date"></div>
            </div>
            
            <div class="balance-info">
                <div class="balance-header">
                    <i class="fas fa-wallet"></i>
                    <span>Saldo do Caixa</span>
                    <button class="toggle-balance" id="toggle-balance">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <div class="balance-details">
                    <div class="balance-item" id="opening-balance">
                        <span>Abertura:</span>
                        <span class="balance-value">R$ 0.00</span>
                    </div>
                    <div class="balance-item" id="current-balance">
                        <span>Saldo atual:</span>
                        <span class="balance-value">R$ 0.00</span>
                    </div>
                </div>
            </div>
            
            <nav class="main-menu">
                <button class="menu-item active" id="sales-tab" data-tab="sales">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Vendas</span>
                </button>
                <button class="menu-item" id="day-sales-tab" data-tab="day-sales">
                    <i class="fas fa-list"></i>
                    <span>Vendas do Dia</span>
                </button>
                <button class="menu-item" id="clients-tab" data-tab="clients">
                    <i class="fas fa-users"></i>
                    <span>Clientes</span>
                </button>
                <button class="btn-danger" id="open-expense-modal-btn">
                    <i class="fas fa-minus-circle"></i> Cadastrar Despesa
                </button>
                <button class="btn-close" id="close-register-btn">
                    <i class="fas fa-lock"></i> Fechar Caixa
                </button>
            </nav>
            
            <button class="btn-logout" id="logout-btn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Sair</span>
            </button>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="content-header">
                <h1 id="current-tab-title">Vendas</h1>
                <div class="actions">
                    {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    {% endif %}
                    {% endwith %}
                </div>
            </div>
            
            <!-- Status do Caixa Centralizado -->
            <div class="status-container">
                <div id="caixa-status-display" class="caixa-status caixa-livre">
                    <i class="fas fa-check-circle"></i>
                    <span>CAIXA LIVRE</span>
                </div>
            </div>
            
            <!-- Tab Contents -->
            <div class="tab-content active" id="sales">
                <!-- Client Search Section -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-user"></i>
                        <h3>Informações do Cliente</h3>
                    </div>
                    <div class="card-body">
                        <div class="search-container">
                            <div class="search-input-group">
                                <input type="text" id="client-search-input" class="search-input" placeholder="Buscar por nome, CPF ou telefone..." autocomplete="off">
                                <button class="btn-search" id="search-client-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="search-results-dropdown" id="client-search-results"></div>
                            <div class="client-info-display">
                                <input type="text" id="selected-client" placeholder="Cliente selecionado" readonly>
                                <input type="hidden" id="selected-client-id">
                                <!-- Botão para remover o cliente selecionado -->
                                <button class="remove-btn" id="remove-selected-client-btn" title="Remover cliente">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Products Section -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-box-open"></i>
                        <h3>Produtos da Venda</h3>
                    </div>
                    <div class="card-body">
                        <div class="search-container">
                            <div class="search-input-group">
                                <input type="text" id="product-search-input" class="search-input" placeholder="Buscar por nome, marca ou código..." autocomplete="off">
                                <button class="btn-search" id="search-product-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="search-results-dropdown" id="product-search-results"></div>
                        </div>
                        
                        <!-- Products List -->
                        <div class="products-table-container">
                            <table class="products-table">
                                <thead>
                                    <tr>
                                        <th>Produto</th>
                                        <th>Descrição</th>
                                        <th>Valor Unitário</th>
                                        <th>Quantidade</th>
                                        <th>Total</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="products-list">
                                    <!-- Products will be added here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <button class="btn-add-product" id="add-product-btn">
                            <i class="fas fa-plus"></i> Adicionar Produto
                        </button>
                    </div>
                </div>
                
                <!-- Payment Section -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-money-bill-wave"></i>
                        <h3>Finalização da Venda</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <div class="delivery-buttons">
                                <button class="btn-delivery" id="delivery-btn">
                                    <i class="fas fa-truck"></i> Adicionar Entrega
                                </button>
                                <button class="btn-delivery" id="use-client-address-btn" title="Usar endereço do cliente">
                                    <i class="fas fa-user"></i> Endereço do Cliente
                                </button>
                            </div>
                        </div>
                        <div id="delivery-info-display" style="margin-top: 10px; display: none;">
                            <p><strong>Endereço de Entrega:</strong> <span id="delivery-address-text"></span></p>
                            <button class="btn-remove-address" title="Remover endereço">
                                <i class="fas fa-times"></i> Remover
                            </button>
                        </div>
                        
                        <!-- Controle de Desconto Manual -->
                        <div class="form-group">
                            <label>Desconto Manual</label>
                            <div class="discount-control">
                                <select class="form-control discount-type-select" id="discount-type">
                                    <option value="percentual">Percentual (%)</option>
                                    <option value="fixo">Valor Fixo (R$)</option>
                                </select>
                                <input type="text" 
                                    class="form-control" 
                                    id="discount-value" 
                                    placeholder="Valor"
                                    pattern="[0-9]+([,\.][0-9]+)?" 
                                    title="Use números com ponto ou vírgula como separador decimal">
                                <button class="btn-primary" id="apply-discount-btn">
                                    Aplicar Desconto
                                </button>
                            </div>
                        </div>
                        
                        <!-- Formas de Pagamento -->
                        <div class="payment-methods-container">
                            <div class="form-group">
                                <label>Formas de Pagamento</label>
                                <div class="payment-method-input">
                                    <select class="form-control payment-method-select">
                                        <option value="">Selecione...</option>
                                        <option value="pix_fabiano">Pix - Fabiano</option>
                                        <option value="pix_edfrance">Pix - Edfrance</option>
                                        <option value="pix_loja">Pix - Loja</option>
                                        <option value="pix_maquineta">Pix - Maquineta</option>
                                        <option value="dinheiro">Dinheiro</option>
                                        <option value="cartao_credito">Cartão de Crédito</option>
                                        <option value="cartao_debito">Cartão de Débito</option>
                                        <option value="a_prazo">A Prazo [Fiado]</option>
                                    </select>
                                    <input type="text" class="form-control payment-amount" placeholder="Valor">
                                    <button class="btn btn-primary add-payment-method">Adicionar</button>
                                </div>
                            </div>
                            
                            <div class="selected-payments-list">
                                <!-- Os pagamentos adicionados aparecerão aqui -->
                            </div>
                        </div>
                        
                        <!-- Sale Summary -->
                        <div class="sale-summary">
                            <div class="summary-row">
                                <span>Subtotal:</span>
                                <span id="subtotal-value">R$ 0.00</span>
                            </div>
                            
                            <div class="summary-row discount-row">
                                <span>Descontos:</span>
                                <span id="discount-value">R$ 0.00</span>
                            </div>
                            
                            <div class="summary-row total">
                                <span>Total da Venda:</span>
                                <span id="sale-total">R$ 0.00</span>
                            </div>
                            
                            <div class="form-group">
                                <label for="amount-received">Valor Recebido</label>
                                <input type="text" id="amount-received" class="form-control currency-input" placeholder="Digite o valor recebido">
                            </div>
                            
                            <div class="summary-row change">
                                <span>Troco:</span>
                                <span id="change-value">R$ 0.00</span>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="action-buttons">
                            <button class="btn-primary" id="register-sale-btn">
                                <i class="fas fa-cash-register"></i> Registrar Venda
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Vendas do Dia Tab -->
            <div class="tab-content" id="day-sales">
                <div class="card">
                    <div class="card-header">
                        <div class="card-header-title">
                            <i class="fas fa-list"></i>
                            <h3>Vendas do Dia</h3>
                        </div>
                        <div class="card-header-actions">
                            <button class="btn-secondary" id="generate-pdf-btn">
                                <i class="fas fa-file-pdf"></i> Gerar PDF
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <table class="sales-day-table" id="day-sales-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Data/Hora</th>
                                    <th>Cliente</th>
                                    <th>Valor Total</th>
                                    <th>Pagamento</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Vendas serão carregadas aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- Sale Details Modal -->
            <div class="modal" id="sale-details-modal">
                <div class="modal-content" style="max-width: 800px;">
                    <div class="modal-header">
                        <h3>Detalhes da Venda #<span id="sale-details-id"></span></h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="sale-details-container">
                            <div class="sale-details-section">
                                <h4>Informações Básicas</h4>
                                <div class="detail-row">
                                    <span class="detail-label">Data/Hora:</span>
                                    <span id="sale-details-date"></span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Cliente:</span>
                                    <span id="sale-details-client"></span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Operador:</span>
                                    <span id="sale-details-operator"></span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Valor Total:</span>
                                    <span id="sale-details-total"></span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Desconto:</span>
                                    <span id="sale-details-discount"></span>
                                </div>
                                <div class="detail-row" id="sale-details-delivery-container" style="display: none;">
                                    <span class="detail-label">Endereço Entrega:</span>
                                    <span id="sale-details-delivery"></span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Observações:</span>
                                    <span id="sale-details-notes"></span>
                                </div>
                            </div>
                            
                            <div class="sale-details-section">
                                <h4>Produtos</h4>
                                <table class="sale-products-table">
                                    <thead>
                                        <tr>
                                            <th>Produto</th>
                                            <th>Qtd</th>
                                            <th>Valor Unit.</th>
                                            <th>Desconto</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody id="sale-details-products">
                                        <!-- Products will be added here -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="sale-details-section">
                                <h4>Pagamentos</h4>
                                <table class="sale-payments-table">
                                    <thead>
                                        <tr>
                                            <th>Forma</th>
                                            <th>Valor</th>
                                            <th>Data/Hora</th>
                                        </tr>
                                    </thead>
                                    <tbody id="sale-details-payments">
                                        <!-- Payments will be added here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" onclick="closeModal('sale-details-modal')">Fechar</button>
                    </div>
                </div>
            </div>
            <!-- Clients Tab -->
            <div class="tab-content" id="clients">
                <div class="card">
                    <div class="card-header">
                        <div class="card-header-title">
                            <i class="fas fa-users"></i>
                            <h3>Clientes Cadastrados</h3>
                        </div>
                        <div class="card-header-actions">
                            <button class="btn-primary" id="add-client-btn">
                                <i class="fas fa-plus"></i> Novo Cliente
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Tabela de clientes -->
                        <div class="clients-table-container">
                            <table class="clients-table" id="clients-table">
                                <thead>
                                    <tr>
                                        <th class="sortable" data-sort="id">
                                            ID
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th class="sortable" data-sort="nome">
                                            Nome
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th class="sortable" data-sort="documento">
                                            Documento
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th class="sortable" data-sort="telefone">
                                            Telefone
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th class="sortable" data-sort="email">
                                            Email
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th class="sortable" data-sort="endereco">
                                            Endereço
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th class="sortable" data-sort="data_cadastro">
                                            Cadastro
                                            <i class="fas fa-sort"></i>
                                        </th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="clients-tbody">
                                    <!-- Clientes serão carregados aqui -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Informações de paginação/total -->
                        <div class="table-footer">
                            <div class="table-info">
                                <span id="clients-count">0 clientes encontrados</span>
                            </div>
                            <div class="pagination-controls" id="pagination-controls">
                                <!-- Controles de paginação serão adicionados aqui se necessário -->
                            </div>
                        </div>
                        
                        <!-- Estado vazio -->
                        <div class="empty-state" id="clients-empty-state" style="display: none;">
                            <div class="empty-icon">
                                <i class="fas fa-users-slash"></i>
                            </div>
                            <h3>Nenhum cliente encontrado</h3>
                            <p>Não há clientes cadastrados ou nenhum cliente corresponde aos critérios de busca.</p>
                            <button class="btn-primary" onclick="document.getElementById('add-client-btn').click()">
                                <i class="fas fa-plus"></i> Cadastrar Primeiro Cliente
                            </button>
                        </div>
                        
                        <!-- Loading state -->
                        <div class="loading-state" id="clients-loading" style="display: none;">
                            <div class="spinner"></div>
                            <p>Carregando clientes...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Client Modal -->
    <div class="modal" id="client-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="client-modal-title">Cadastrar Cliente</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="client-form">
                    <div class="form-group">
                        <label for="client-name">Nome:</label>
                        <input type="text" id="client-name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="client-document">Documento:</label>
                        <input type="text" id="client-document" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="client-phone">Telefone:</label>
                        <input type="text" id="client-phone" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="client-email">Email:</label>
                        <input type="email" id="client-email" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="client-address">Endereço:</label>
                        <input type="text" id="client-address" class="form-control">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancel-client">Cancelar</button>
                <button class="btn-primary" id="save-client">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Product Search Modal -->
    <div class="modal" id="product-search-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Selecionar Produto</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="search-input-group">
                    <input type="text" id="modal-product-search" placeholder="Buscar por nome, marca ou código...">
                    <button class="btn-search" id="modal-search-product-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                
                <div class="search-results" id="product-search-results">
                    <!-- Search results will appear here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancel-product-search">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Delivery Modal -->
    <div class="modal" id="delivery-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Informações de Entrega</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="delivery-form">
                    <div class="form-group">
                        <label for="delivery-address">Endereço:</label>
                        <input type="text" id="delivery-address" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-number">Número:</label>
                        <input type="text" id="delivery-number" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-complement">Complemento:</label>
                        <input type="text" id="delivery-complement" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-neighborhood">Bairro:</label>
                        <input type="text" id="delivery-neighborhood" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-city">Cidade:</label>
                        <input type="text" id="delivery-city" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-state">Estado:</label>
                        <input type="text" id="delivery-state" class="form-control" maxlength="2">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-zipcode">CEP:</label>
                        <input type="text" id="delivery-zipcode" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="delivery-instructions">Instruções de entrega:</label>
                        <textarea id="delivery-instructions" class="form-control" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancel-delivery">Cancelar</button>
                <button class="btn-primary" id="save-delivery">Salvar Endereço</button>
            </div>
        </div>
    </div>
    
    <!-- Expense Modal -->
    <div class="modal" id="expense-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nova Despesa</h3>
                <button class="modal-close" onclick="closeExpenseModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="expense-form">
                    <div class="form-group">
                        <label for="expense-description">Descrição da Despesa:</label>
                        <input type="text" id="expense-description" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="expense-amount">Valor:</label>
                        <input type="number" id="expense-amount" class="form-control" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="expense-note">Observação:</label>
                        <textarea id="expense-note" class="form-control" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeExpenseModal()">Cancelar</button>
                <button class="btn-primary" onclick="saveExpense()">Salvar Despesa</button>
            </div>
        </div>
    </div>

    <!-- Void Sale Modal -->
    <div class="modal" id="void-sale-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Estornar Venda #<span id="void-sale-id-display"></span></h3>
                <button class="modal-close" onclick="closeModal('void-sale-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Você está prestes a estornar esta venda. Esta ação não pode ser desfeita.</p>
                <div class="form-group">
                    <label for="void-sale-reason">Motivo do Estorno:</label>
                    <textarea id="void-sale-reason" class="form-control" rows="3" placeholder="Descreva o motivo do estorno..."></textarea>
                </div>
                <input type="hidden" id="void-sale-id">
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal('void-sale-modal')">Cancelar</button>
                <button class="btn-danger" onclick="voidSale()">
                    <i class="fas fa-undo"></i> Confirmar Estorno
                </button>
            </div>
        </div>
    </div>
    <!-- Modal de Detalhes do Cliente -->
    <div id="clientDetailsModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalhes do Cliente</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <h6><strong>Nome:</strong> <span id="clientName"></span></h6>
                            <h6><strong>Documento:</strong> <span id="clientDocument"></span></h6>
                        </div>
                        <div class="col-md-6">
                            <h6><strong>Limite de Crédito:</strong> R$ <span id="clientCreditLimit"></span></h6>
                            <h6><strong>Saldo Devedor:</strong> R$ <span id="clientBalance"></span></h6>
                        </div>
                    </div>
                    
                    <h5 class="mb-3">Compras Realizadas</h5>
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                            <thead class="thead-light">
                                <tr>
                                    <th>Data</th>
                                    <th>Nota Fiscal</th>
                                    <th>Valor Total</th>
                                    <th>Status</th>
                                    <th>Valor Pendente</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="clientPurchasesTable">
                                <!-- Dados serão preenchidos via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Pagamento -->
    <div id="paymentModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Registrar Pagamento</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="paymentForm">
                        <input type="hidden" id="contaReceberId">
                        <input type="hidden" id="notaFiscalId">
                        <div class="form-group">
                            <label for="valorPendente">Valor Pendente</label>
                            <input type="text" class="form-control" id="valorPendente" readonly>
                        </div>
                        <div class="form-group">
                            <label for="valorPagamento">Valor do Pagamento *</label>
                            <input type="number" step="0.01" class="form-control" id="valorPagamento" required>
                        </div>
                        <div class="form-group">
                            <label for="formaPagamento">Forma de Pagamento *</label>
                            <select class="form-control" id="formaPagamento" required>
                                <option value="">Selecione...</option>
                                <option value="pix_fabiano">PIX Fabiano</option>
                                <option value="pix_maquineta">PIX Maquineta</option>
                                <option value="pix_edfrance">PIX EDFrance</option>
                                <option value="pix_loja">PIX Loja</option>
                                <option value="dinheiro">Dinheiro</option>
                                <option value="cartao_credito">Cartão de Crédito</option>
                                <option value="cartao_debito">Cartão de Débito</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="observacoes">Observações</label>
                            <textarea class="form-control" id="observacoes" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="confirmPayment">Confirmar Pagamento</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="notification-content">
            <span id="notification-message"></span>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/script_operador.js') }}"></script>
</body>
</html>